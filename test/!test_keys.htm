<html>
<!--body onKeyDown="key_event_down();" onKeyUp="key_event_up();" onKeyPress="key_event_press();"-->
<body onKeyPress="key_event(event);">
<script>

var selected_row_obj = null;

// clears any text selection on page
function clearSelection()
{
	var sel, body;
	if( document.selection && document.selection.empty )
	{
		document.selection.empty() ;
	}
	else if( window.getSelection )
	{
		sel = window.getSelection();
		body = document.getElementsByTagName("body")[0];
		window.getSelection().collapse(body,0);
	}
}

// mark table row
function select_row(row_obj)
{
	document.my_form.selected_row.value = row_obj.id;	// debug

	if( row_obj.id == 'row_0' )
		return;		// don't mark the header
	if( selected_row_obj )
		selected_row_obj.style.backgroundColor = 'white';
	selected_row_obj = row_obj;
	selected_row_obj.style.backgroundColor = 'black';
}

// confirm row selection
function confirm_row(row_obj)
{
	alert(selected_row_obj.id);
}

// got key event
function key_event(e)
{
	var evt, offset;

	evt = window.event ? window.event : e;
	document.my_form.type.value = evt.type;
	document.my_form.keyCode.value = evt.keyCode;

	offset = 0;
	switch( evt.keyCode )
	{
		case 38: offset = -1; break; // arrow up
		case 40: offset = 1; break; // arrow down
//		case 33: offset = -20; break; // page up
//		case 34: offset = 20; break; // page down
	}

	if( offset )
	{
		if( selected_row_obj )
			current_row_index = selected_row_obj.rowIndex;
		else
			current_row_index = 1;

		current_row_index += offset;

		if( current_row_index < 1 )
			current_row_index = 1; // except header (row_0)
		if( current_row_index > 50 )	// max!!!!!!!
			current_row_index = 50;
		current_row_id = 'row_' + current_row_index;
		select_row(document.getElementById(current_row_id));
	}

	if( evt.keyCode == 13 ) // enter
	{
		if( selected_row_obj )
			confirm_row(selected_row_obj);
	}
}


</script>
<form name=my_form>
type : <input type=text name=type value=""><br>
keyCode : <input type=text name=keyCode value=""><br>
selected row : <input type=text name=selected_row value=""><br>
</form>

<table cellspacing="1" border="1">
<tr id="row_0" onClick="select_row(this);">
<th width="200" height="20">1</th><th width="200">2</th><th width="200">3</th>
</tr>
<tr id="row_1" onClick="select_row(this);" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_2" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_3" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_4" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_5" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_6" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_7" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_8" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_9" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_10" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_11" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_12" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_13" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_14" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_15" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_16" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_17" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_18" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_19" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_20" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_21" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_22" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_23" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_24" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_25" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_26" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_27" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_28" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_29" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_30" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_31" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_32" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_33" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_34" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_35" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_36" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_37" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_38" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_39" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_40" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_41" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_42" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_43" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_44" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_45" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_46" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_47" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_48" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_49" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
<tr id="row_50" onClick="select_row(this)" onDblClick="clearSelection(); confirm_row(this);">
<td width="200" height="20"></td><td width="200"></td><td width="200"></td>
</tr>
</table>

</body>
</html>